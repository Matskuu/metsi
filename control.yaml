#Application configuration values. Can be overriden by CLI arguments. May be commented out for None or default from Mela2Configuration.
app_configuration:
  state_format: fdm #options: fdm, vmi12, vmi13, forest_centre
  state_input_container: csv #Only relevant with fdm state_format. Options: pickle, json
  #preprocessing_output_container: csv #options: pickle, json, csv, null, rsd (special case not usable as input container)
  #state_output_container: csv #options: pickle, json, csv, null
  #derived_data_output_container: pickle #options: pickle, json, null
  strategy: partial
  run_modes: preprocess,simulate,postprocess

run_constraints:
  thinning_from_below:
    minimum_time_interval: 10

operation_params:
  report_volume:
    # Requires R dependency if true
    - lmfor_volume: false
  first_thinning:
    - thinning_factor: 0.97
      e: 0.2
      dominant_height_lower_bound: 11
      dominant_height_upper_bound: 16
  thinning_from_below:
    - thinning_factor: 0.97
      e: 0.2
    - thinning_factor: 0.8
      e: 0.2
  thinning_from_above:
    - thinning_factor: 0.98
      e: 0.2
  even_thinning:
    - thinning_factor: 0.9
      e: 0.2
  report_overall_removal:
    - thinning_method:
      - thinning_from_below
      - thinning_from_above
      - first_thinning
      - even_thinning
  report_biomass:
    - model_set: 1
  report_collectives:
    - Ftot: reference_trees.stems_per_ha
      Fpine: reference_trees.stems_per_ha[reference_trees.species==1]
      Fbirch: reference_trees.stems_per_ha[(reference_trees.species==3)|(reference_trees.species==4)]
  grow_fhk:
    - package: pymotti_graph
  report_state:
    - dbh: reference_trees.breast_height_diameter
      height: reference_trees.height
  report_state:
    - cross_cut_vol_pine: cross_cutting.volume_per_ha[(cross_cutting.species == 1)]
     
preprocessing_params:
  generate_reference_trees:
    - n_trees: 10
  filter:
    - remove trees: sapling or stems_per_ha == 0
      remove: not reference_trees

preprocessing_operations:
  - generate_reference_trees # comment out if input data contains direct trees (vmi12 or vmi13)
  - filter
  - compute_location_metadata

operation_file_params:
  thinning_from_above:
    thinning_limits: data/parameter_files/Thin.txt
  cross_cut_felled_trees:
    timber_price_table: data/parameter_files/timber_price_table.csv
  clearcutting:
    clearcutting_limits_ages: data/parameter_files/renewal_ages_southernFI.txt  
    clearcutting_limits_diameters: data/parameter_files/renewal_diameters_southernFI.txt 
    clearcutting_instructions: data/parameter_files/clearcut_instructions.txt

simulation_events:
  # we describe here objects with schedule for which time points they are active
  - time_points: [0]
    generators:
      - sequence:
          - report_volume
          - report_biomass
  - time_points: [0, 5, 10, 15, 20, 25, 30]
    generators:
      - sequence:
        - grow_acta
        #- grow_motti
        # requires fhk dependencies from fhk-requirements.txt
        #- grow_fhk
  - time_points: [5, 15, 25]
    generators:
      - alternatives:
          - do_nothing
          - thinning_from_below
          - thinning_from_above
          - first_thinning
          - even_thinning
          - clearcutting
  - time_points: [30]
    generators:
      - sequence:
          - report_volume
          - report_biomass
          - report_overall_removal
  - time_points: [0,20]
    generators:
      - sequence:
          - cross_cut_felled_trees
          - report_state

post_processing:
  operation_params:
    do_nothing:
      - param: value

  post_processing:
    - do_nothing

export:
  format: J

  cvariables:
    - year
    - site_type_category
    - land_use_category
    - soil_peatland_category

  xvariables:
    - Ftot[0]
    - Fpine[0,5,10]
    - int(site_type_category < 7) * sum(Fbirch)
